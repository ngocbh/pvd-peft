Thu Nov 30 02:56:07 EST 2023
r904u07n04.grace.ycrc.yale.edu
/home/nhb25/palmer_scratch/pre-training-via-denoising
/vast/palmer/scratch/ying_rex/nhb25/pre-training-via-denoising
./scripts/train.sh qm9_peft
Global seed set to 1
/home/nhb25/.conda/envs/pvd/lib/python3.9/site-packages/torch_geometric/deprecation.py:13: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
/home/nhb25/.conda/envs/pvd/lib/python3.9/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 6 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Namespace(load_model=None, conf=None, num_epochs=3000, num_steps=300000, batch_size=128, inference_batch_size=128, lr=0.0004, lr_schedule='cosine', lr_patience=15, lr_min=1e-07, lr_factor=0.8, lr_warmup_steps=10000, lr_cosine_length=300000, early_stopping_patience=1500, weight_decay=0.0, ema_alpha_y=1.0, ema_alpha_dy=1.0, ngpus=-1, num_nodes=1, precision=32, log_dir='experiments/qm9_peft', splits=None, train_size=110000, val_size=10000, test_size=None, test_interval=10, save_interval=10, seed=1, distributed_backend='ddp', num_workers=6, redirect=False, wandb_notes='', job_id='qm9_peft', pretrained_model='checkpoints/denoised-pcqm4mv2.ckpt', peft='ia3', dataset='QM9', dataset_root='data/qm9', dataset_arg='homo', coord_files=None, embed_files=None, energy_files=None, force_files=None, energy_weight=1.0, force_weight=1.0, position_noise_scale=0.005, denoising_weight=0.1, denoising_only=False, model='equivariant-transformer-ia3', output_model='Scalar', prior_model=None, output_model_noise='VectorOutput', embedding_dimension=256, num_layers=8, num_rbf=64, activation='silu', rbf_type='expnorm', trainable_rbf=False, neighbor_embedding=True, aggr='add', distance_influence='both', attn_activation='silu', num_heads=8, layernorm_on_vec='whitened', derivative=False, cutoff_lower=0.0, cutoff_upper=5.0, atom_filter=-1, max_z=100, max_num_neighbors=32, standardize=True, reduce_op='add')
train 110000, val 10000, test 10831
computing mean and std:   0%|          | 0/860 [00:00<?, ?it/s]computing mean and std:   0%|          | 1/860 [00:02<42:23,  2.96s/it]computing mean and std:   1%|          | 6/860 [00:03<05:37,  2.53it/s]computing mean and std:   1%|▏         | 12/860 [00:03<02:24,  5.87it/s]computing mean and std:   2%|▏         | 16/860 [00:03<01:44,  8.05it/s]computing mean and std:   2%|▏         | 20/860 [00:03<01:18, 10.64it/s]computing mean and std:   3%|▎         | 24/860 [00:03<01:04, 12.99it/s]computing mean and std:   3%|▎         | 27/860 [00:04<01:35,  8.70it/s]computing mean and std:   3%|▎         | 29/860 [00:04<01:26,  9.60it/s]computing mean and std:   4%|▎         | 31/860 [00:04<01:18, 10.56it/s]computing mean and std:   4%|▍         | 34/860 [00:04<01:02, 13.23it/s]computing mean and std:   5%|▍         | 39/860 [00:04<00:46, 17.82it/s]computing mean and std:   5%|▍         | 42/860 [00:05<00:44, 18.56it/s]computing mean and std:   5%|▌         | 46/860 [00:05<00:37, 21.50it/s]computing mean and std:   6%|▌         | 49/860 [00:05<00:35, 22.67it/s]computing mean and std:   6%|▌         | 52/860 [00:05<00:33, 24.30it/s]computing mean and std:   7%|▋         | 56/860 [00:05<00:30, 26.54it/s]computing mean and std:   7%|▋         | 59/860 [00:05<00:33, 23.71it/s]computing mean and std:   7%|▋         | 62/860 [00:05<00:31, 25.10it/s]computing mean and std:   8%|▊         | 66/860 [00:05<00:28, 27.77it/s]computing mean and std:   8%|▊         | 69/860 [00:06<00:30, 25.53it/s]computing mean and std:   8%|▊         | 72/860 [00:06<00:31, 24.97it/s]computing mean and std:   9%|▉         | 76/860 [00:06<00:31, 25.05it/s]computing mean and std:   9%|▉         | 79/860 [00:06<00:30, 25.50it/s]computing mean and std:  10%|▉         | 82/860 [00:06<00:30, 25.55it/s]computing mean and std:  10%|█         | 86/860 [00:06<00:28, 26.73it/s]computing mean and std:  10%|█         | 90/860 [00:06<00:29, 26.13it/s]computing mean and std:  11%|█         | 94/860 [00:07<00:29, 25.97it/s]computing mean and std:  11%|█▏        | 98/860 [00:07<00:27, 27.47it/s]computing mean and std:  12%|█▏        | 101/860 [00:07<00:27, 28.04it/s]computing mean and std:  12%|█▏        | 104/860 [00:07<00:27, 27.37it/s]computing mean and std:  12%|█▏        | 107/860 [00:07<00:27, 27.21it/s]computing mean and std:  13%|█▎        | 111/860 [00:07<00:27, 27.50it/s]computing mean and std:  13%|█▎        | 114/860 [00:07<00:27, 27.52it/s]computing mean and std:  14%|█▎        | 118/860 [00:07<00:27, 26.94it/s]computing mean and std:  14%|█▍        | 122/860 [00:08<00:27, 27.18it/s]computing mean and std:  15%|█▍        | 126/860 [00:08<00:26, 27.22it/s]computing mean and std:  15%|█▌        | 130/860 [00:08<00:25, 28.27it/s]computing mean and std:  15%|█▌        | 133/860 [00:08<00:25, 28.14it/s]computing mean and std:  16%|█▌        | 136/860 [00:08<00:26, 27.65it/s]computing mean and std:  16%|█▌        | 139/860 [00:08<00:25, 28.05it/s]computing mean and std:  17%|█▋        | 142/860 [00:08<00:26, 27.09it/s]computing mean and std:  17%|█▋        | 146/860 [00:08<00:26, 26.73it/s]computing mean and std:  17%|█▋        | 150/860 [00:09<00:24, 28.93it/s]computing mean and std:  18%|█▊        | 153/860 [00:09<00:25, 28.10it/s]computing mean and std:  18%|█▊        | 156/860 [00:09<00:24, 28.52it/s]computing mean and std:  18%|█▊        | 159/860 [00:09<00:24, 28.45it/s]computing mean and std:  19%|█▉        | 163/860 [00:09<00:23, 29.06it/s]computing mean and std:  19%|█▉        | 167/860 [00:09<00:24, 28.41it/s]computing mean and std:  20%|█▉        | 170/860 [00:09<00:26, 25.96it/s]computing mean and std:  20%|██        | 175/860 [00:09<00:22, 30.19it/s]computing mean and std:  21%|██        | 179/860 [00:10<00:22, 30.45it/s]computing mean and std:  21%|██▏       | 183/860 [00:10<00:23, 29.43it/s]computing mean and std:  22%|██▏       | 186/860 [00:10<00:23, 28.88it/s]computing mean and std:  22%|██▏       | 189/860 [00:10<00:23, 28.24it/s]computing mean and std:  22%|██▏       | 193/860 [00:10<00:22, 29.22it/s]computing mean and std:  23%|██▎       | 197/860 [00:10<00:22, 29.26it/s]computing mean and std:  23%|██▎       | 200/860 [00:10<00:25, 26.16it/s]computing mean and std:  24%|██▎       | 204/860 [00:10<00:22, 29.44it/s]computing mean and std:  24%|██▍       | 208/860 [00:11<00:21, 29.90it/s]computing mean and std:  25%|██▍       | 212/860 [00:11<00:23, 27.51it/s]computing mean and std:  25%|██▌       | 216/860 [00:11<00:23, 27.33it/s]computing mean and std:  26%|██▌       | 220/860 [00:11<00:22, 28.29it/s]computing mean and std:  26%|██▌       | 223/860 [00:12<00:44, 14.26it/s]computing mean and std:  26%|██▋       | 226/860 [00:12<00:43, 14.46it/s]computing mean and std:  27%|██▋       | 228/860 [00:12<00:46, 13.55it/s]computing mean and std:  27%|██▋       | 233/860 [00:12<00:36, 17.37it/s]computing mean and std:  28%|██▊       | 240/860 [00:12<00:31, 19.82it/s]computing mean and std:  29%|██▊       | 246/860 [00:13<00:25, 24.04it/s]computing mean and std:  29%|██▉       | 251/860 [00:13<00:22, 27.66it/s]computing mean and std:  30%|██▉       | 255/860 [00:13<00:22, 26.44it/s]computing mean and std:  30%|███       | 258/860 [00:13<00:25, 23.69it/s]computing mean and std:  31%|███       | 264/860 [00:13<00:20, 28.84it/s]computing mean and std:  31%|███▏      | 269/860 [00:13<00:19, 30.81it/s]computing mean and std:  32%|███▏      | 273/860 [00:13<00:18, 31.39it/s]computing mean and std:  32%|███▏      | 277/860 [00:14<00:22, 26.49it/s]computing mean and std:  33%|███▎      | 282/860 [00:14<00:22, 26.22it/s]computing mean and std:  33%|███▎      | 288/860 [00:14<00:21, 26.86it/s]computing mean and std:  34%|███▍      | 294/860 [00:14<00:20, 28.18it/s]computing mean and std:  35%|███▍      | 300/860 [00:14<00:19, 28.87it/s]computing mean and std:  36%|███▌      | 306/860 [00:15<00:18, 30.32it/s]computing mean and std:  36%|███▋      | 312/860 [00:15<00:17, 31.55it/s]computing mean and std:  37%|███▋      | 318/860 [00:15<00:16, 32.58it/s]computing mean and std:  38%|███▊      | 324/860 [00:15<00:16, 33.33it/s]computing mean and std:  38%|███▊      | 330/860 [00:15<00:15, 33.57it/s]computing mean and std:  39%|███▉      | 336/860 [00:15<00:15, 33.95it/s]computing mean and std:  40%|███▉      | 342/860 [00:16<00:15, 33.78it/s]computing mean and std:  40%|████      | 348/860 [00:16<00:15, 32.12it/s]computing mean and std:  41%|████      | 354/860 [00:16<00:16, 30.82it/s]computing mean and std:  42%|████▏     | 360/860 [00:16<00:16, 30.26it/s]computing mean and std:  43%|████▎     | 366/860 [00:16<00:16, 29.67it/s]computing mean and std:  43%|████▎     | 372/860 [00:17<00:16, 29.47it/s]computing mean and std:  44%|████▍     | 378/860 [00:17<00:16, 29.52it/s]computing mean and std:  45%|████▍     | 384/860 [00:17<00:16, 29.39it/s]computing mean and std:  45%|████▌     | 390/860 [00:17<00:15, 29.61it/s]computing mean and std:  46%|████▌     | 396/860 [00:17<00:16, 28.68it/s]computing mean and std:  47%|████▋     | 401/860 [00:18<00:14, 31.34it/s]computing mean and std:  47%|████▋     | 405/860 [00:18<00:13, 32.57it/s]computing mean and std:  48%|████▊     | 409/860 [00:18<00:16, 27.69it/s]computing mean and std:  48%|████▊     | 414/860 [00:18<00:16, 26.44it/s]computing mean and std:  49%|████▉     | 420/860 [00:18<00:16, 27.14it/s]computing mean and std:  50%|████▉     | 426/860 [00:19<00:31, 13.88it/s]computing mean and std:  50%|█████     | 432/860 [00:19<00:27, 15.51it/s]computing mean and std:  51%|█████     | 437/860 [00:20<00:23, 18.06it/s]computing mean and std:  51%|█████     | 440/860 [00:20<00:22, 18.71it/s]computing mean and std:  52%|█████▏    | 444/860 [00:20<00:21, 19.19it/s]computing mean and std:  52%|█████▏    | 450/860 [00:20<00:19, 21.56it/s]computing mean and std:  53%|█████▎    | 456/860 [00:20<00:17, 23.41it/s]computing mean and std:  54%|█████▎    | 462/860 [00:21<00:16, 24.78it/s]computing mean and std:  54%|█████▍    | 468/860 [00:21<00:15, 26.08it/s]computing mean and std:  55%|█████▌    | 474/860 [00:21<00:14, 27.13it/s]computing mean and std:  56%|█████▌    | 480/860 [00:21<00:13, 27.24it/s]computing mean and std:  57%|█████▋    | 486/860 [00:21<00:13, 27.71it/s]computing mean and std:  57%|█████▋    | 492/860 [00:22<00:13, 28.01it/s]computing mean and std:  58%|█████▊    | 498/860 [00:22<00:12, 27.94it/s]computing mean and std:  59%|█████▊    | 504/860 [00:22<00:12, 27.99it/s]computing mean and std:  59%|█████▉    | 510/860 [00:22<00:12, 28.08it/s]computing mean and std:  60%|██████    | 516/860 [00:22<00:11, 28.85it/s]computing mean and std:  61%|██████    | 522/860 [00:23<00:12, 27.95it/s]computing mean and std:  61%|██████▏   | 528/860 [00:23<00:12, 27.33it/s]computing mean and std:  62%|██████▏   | 534/860 [00:23<00:12, 27.15it/s]computing mean and std:  63%|██████▎   | 540/860 [00:23<00:10, 29.80it/s]computing mean and std:  63%|██████▎   | 546/860 [00:24<00:11, 27.32it/s]computing mean and std:  64%|██████▍   | 552/860 [00:24<00:11, 27.58it/s]computing mean and std:  65%|██████▍   | 558/860 [00:24<00:11, 27.24it/s]computing mean and std:  66%|██████▌   | 564/860 [00:24<00:10, 27.86it/s]computing mean and std:  66%|██████▋   | 570/860 [00:24<00:10, 27.64it/s]computing mean and std:  67%|██████▋   | 576/860 [00:25<00:10, 27.33it/s]computing mean and std:  68%|██████▊   | 582/860 [00:25<00:09, 29.30it/s]computing mean and std:  68%|██████▊   | 587/860 [00:25<00:08, 32.11it/s]computing mean and std:  69%|██████▊   | 591/860 [00:25<00:08, 31.34it/s]computing mean and std:  69%|██████▉   | 595/860 [00:25<00:09, 27.02it/s]computing mean and std:  70%|██████▉   | 600/860 [00:26<00:10, 25.99it/s]computing mean and std:  70%|███████   | 606/860 [00:26<00:09, 27.72it/s]computing mean and std:  71%|███████   | 612/860 [00:26<00:09, 26.87it/s]computing mean and std:  72%|███████▏  | 618/860 [00:26<00:08, 27.32it/s]computing mean and std:  73%|███████▎  | 624/860 [00:26<00:08, 27.44it/s]computing mean and std:  73%|███████▎  | 630/860 [00:27<00:08, 27.61it/s]computing mean and std:  74%|███████▍  | 636/860 [00:27<00:07, 28.51it/s]computing mean and std:  75%|███████▍  | 642/860 [00:27<00:07, 28.42it/s]computing mean and std:  75%|███████▌  | 648/860 [00:27<00:07, 27.56it/s]computing mean and std:  76%|███████▌  | 654/860 [00:27<00:07, 27.88it/s]computing mean and std:  77%|███████▋  | 660/860 [00:28<00:07, 27.95it/s]computing mean and std:  77%|███████▋  | 666/860 [00:28<00:06, 28.02it/s]computing mean and std:  78%|███████▊  | 672/860 [00:28<00:06, 28.17it/s]computing mean and std:  79%|███████▉  | 678/860 [00:28<00:06, 28.02it/s]computing mean and std:  80%|███████▉  | 684/860 [00:29<00:06, 28.11it/s]computing mean and std:  80%|████████  | 690/860 [00:29<00:06, 28.26it/s]computing mean and std:  81%|████████  | 696/860 [00:30<00:12, 13.56it/s]computing mean and std:  82%|████████▏ | 702/860 [00:30<00:10, 14.72it/s]computing mean and std:  82%|████████▏ | 707/860 [00:30<00:08, 17.23it/s]computing mean and std:  83%|████████▎ | 710/860 [00:30<00:08, 18.38it/s]computing mean and std:  83%|████████▎ | 714/860 [00:31<00:07, 18.42it/s]computing mean and std:  84%|████████▎ | 720/860 [00:31<00:06, 21.86it/s]computing mean and std:  84%|████████▍ | 726/860 [00:31<00:05, 22.76it/s]computing mean and std:  85%|████████▌ | 732/860 [00:31<00:05, 24.23it/s]computing mean and std:  86%|████████▌ | 738/860 [00:31<00:04, 25.26it/s]computing mean and std:  87%|████████▋ | 744/860 [00:32<00:04, 26.15it/s]computing mean and std:  87%|████████▋ | 750/860 [00:32<00:04, 26.63it/s]computing mean and std:  88%|████████▊ | 756/860 [00:32<00:03, 27.09it/s]computing mean and std:  89%|████████▊ | 762/860 [00:32<00:03, 27.58it/s]computing mean and std:  89%|████████▉ | 768/860 [00:32<00:03, 27.58it/s]computing mean and std:  90%|█████████ | 774/860 [00:33<00:03, 28.00it/s]computing mean and std:  91%|█████████ | 780/860 [00:33<00:02, 27.76it/s]computing mean and std:  91%|█████████▏| 786/860 [00:33<00:02, 27.66it/s]computing mean and std:  92%|█████████▏| 792/860 [00:33<00:02, 27.59it/s]computing mean and std:  93%|█████████▎| 798/860 [00:34<00:02, 27.96it/s]computing mean and std:  93%|█████████▎| 804/860 [00:34<00:02, 27.65it/s]computing mean and std:  94%|█████████▍| 810/860 [00:34<00:01, 28.12it/s]computing mean and std:  95%|█████████▍| 816/860 [00:34<00:01, 27.81it/s]computing mean and std:  96%|█████████▌| 822/860 [00:34<00:01, 27.82it/s]computing mean and std:  96%|█████████▋| 828/860 [00:35<00:01, 28.18it/s]computing mean and std:  97%|█████████▋| 834/860 [00:35<00:00, 28.10it/s]computing mean and std:  98%|█████████▊| 840/860 [00:35<00:00, 27.24it/s]computing mean and std:  98%|█████████▊| 846/860 [00:35<00:00, 28.49it/s]computing mean and std:  99%|█████████▉| 852/860 [00:35<00:00, 32.28it/s]computing mean and std: 100%|██████████| 860/860 [00:35<00:00, 23.92it/s]
/home/nhb25/.conda/envs/pvd/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:360: UserWarning: Checkpoint directory experiments/qm9_peft exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
/home/nhb25/.conda/envs/pvd/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:396: LightningDeprecationWarning: Argument `period` in `ModelCheckpoint` is deprecated in v1.3 and will be removed in v1.5. Please use `every_n_val_epochs` instead.
  rank_zero_deprecation(
slurmstepd: error: *** JOB 29873560 ON r904u07n04 CANCELLED AT 2023-11-30T02:57:17 ***
